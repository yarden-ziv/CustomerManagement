@model CustomerManagement.ViewModels.CreateCustomerViewModel

<style>
    .form-control, .form-select {
        background-color: #ffffff !important;
        border: 1px solid #c7cfdb !important;
        height: 45px;
    }

    .form-label {
        font-weight: 600;
        color: #1A3C6E;
    }
</style>

<div class="container mt-4 mb-4" style="direction: rtl; text-align:right;">

    <h2 class="mb-2" style="color:white;">הוספת לקוח חדש</h2>
    <div style="width:250px; height:4px; background-color:#FF6A00; margin-bottom:25px; border-radius:2px;"></div>

    <div class="d-flex justify-content-center">
        <div style="width:650px;">
            <div class="card shadow p-3" style="background-color:#f7f9fc; border:1px solid #d0d7e2;">

        <form asp-action="Create">

            <div class="mb-2">
                <label class="form-label">שם מלא (עברית)</label>
                <input asp-for="FullNameHeb" class="form-control" />
                <span asp-validation-for="FullNameHeb" class="text-danger"></span>
            </div>

            <div class="mb-2">
                <label class="form-label">שם מלא (אנגלית)</label>
                <input asp-for="FullNameEng" class="form-control" />
                <span asp-validation-for="FullNameEng" class="text-danger"></span>
            </div>

            <div class="mb-2">
                <label class="form-label">תאריך לידה</label>
                <input asp-for="BirthDate" class="form-control" type="date" max="@DateTime.Now.ToString("yyyy-MM-dd")" />
                <span asp-validation-for="BirthDate" class="text-danger"></span>
            </div>

            <div class="mb-2">
                <label class="form-label">תעודת זהות</label>
                <input asp-for="IdNumber" class="form-control" maxlength="9" />
                <span asp-validation-for="IdNumber" class="text-danger"></span>
            </div>

            <div class="mb-2">
                <label class="form-label">עיר</label>
                <select asp-for="CityId" class="form-select">
                    <option value="">בחר עיר</option>
                    @foreach (var city in Model.Cities)
                    {
                        <option value="@city.Id">@city.Name</option>
                    }
                </select>
                <span asp-validation-for="CityId" class="text-danger"></span>
            </div>

            <div class="mb-2">
                <label class="form-label">בנק</label>
                <select asp-for="BankId" id="bankSelect" class="form-select">
                    <option value="">בחר בנק</option>
                    @foreach (var bank in Model.Banks)
                    {
                        <option value="@bank.Code">@bank.Description</option>
                    }
                </select>

                <span asp-validation-for="BankId" class="text-danger"></span>
            </div>

            <div class="mb-2">
                <label class="form-label">סניף</label>
                <select asp-for="BranchId" id="branchSelect" class="form-select">
                    <option value="">בחר סניף</option>
                </select>
                <span asp-validation-for="BranchId" class="text-danger"></span>
            </div>

            <div class="mb-2">
                <label class="form-label">מספר חשבון</label>
                <input asp-for="AccountNumber" class="form-control" maxlength="12" />
                <span asp-validation-for="AccountNumber" class="text-danger"></span>
            </div>

            <div class="d-flex justify-content-between mt-4">

                <button type="submit" class="btn"
                        style="background-color:#FF6A00; color:white; width:150px;">
                    שמירה
                </button>

                <a href="/Customers/List"
                   class="btn"
                   style="background-color:#1A3C6E; color:white; width:150px;">
                    חזרה לרשימה
                </a>

            </div>

        </form>

            </div> <!-- card -->
        </div> <!-- fixed width -->
    </div> <!-- centered container -->
</div> <!-- blue background container -->
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

    <script>
        document.getElementById("bankSelect").addEventListener("change", function () {
            const bankCode = this.value;

            fetch(`/Customers/GetBranches?bankCode=${bankCode}`)
                .then(response => response.json())
                .then(data => {
                    const branchSelect = document.getElementById("branchSelect");
                    branchSelect.innerHTML = '<option value="">בחר סניף</option>';

                    data.forEach(branch => {
                        branchSelect.innerHTML += `<option value="${branch.branchNumber}">${branch.branchName}</option>`;
                    });
                });
        });
    </script>
}